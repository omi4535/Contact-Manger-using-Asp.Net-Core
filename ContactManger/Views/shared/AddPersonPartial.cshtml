@using ServiceContract.DTO.Countries
@model ServiceContract.DTO.Person.PersonAddReq


<div id="addPersonModal" class="modal">
    <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h2>Add New Person</h2>
        <form method="post" asp-controller="Person" asp-action="Add">
            <div class="form-row">
                <div class="field">
                    <label for="FirstName">First Name</label>
                    <input asp-for="FirstName" />
                    <span asp-validation-for="FirstName" class="text-danger"></span>
                </div>
                <div class="field">
                    <label for="LastName">Last Name</label>
                    <input asp-for="LastName" />
                    <span asp-validation-for="LastName" class="text-danger"></span>
                </div>
            </div>

            <div class="form-row">
                <div class="field">
                    <label asp-for="Email" >Email</label>
                    <input asp-for="Email" />
                    <span asp-validation-for="Email" class="text-danger"></span>
                </div>
                <div class="field">
                    <label for="PhoneNumber">Phone</label>
                    <input type="tel" id="PhoneNumber" name="PhoneNumber" />
                    <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                </div>
            </div>

            <div class="form-row">
                <div class="field">
                    <label for="CountryId">Country</label>
                    <select asp-for="CountryId" asp-items="@ViewBag.CountryDD">
                        <option value="">-- Select Country --</option>
                    </select>
                    <span asp-validation-for="CountryId" class="text-danger"></span>
                </div>
            </div>

            <button type="submit" class="btn-primary" style="margin-top:12px;">Add Person</button>
        </form>
    </div>
</div>

<script>
    // Get modal elements
    const personModal = document.getElementById("addPersonModal");
    const openPersonBtns = document.querySelectorAll("#openPersonModalBtn, #openPersonModalBtn2");
    const closePersonBtn = personModal.querySelector(".close-btn");

    // Open modal on button click
    openPersonBtns.forEach(btn => {
        btn.addEventListener("click", () => {
            personModal.style.display = "block";
        });
    });

    // Close modal on click X
    closePersonBtn.addEventListener("click", () => {
        personModal.style.display = "none";
    });

    // Close modal if click outside modal content
    window.addEventListener("click", (e) => {
        if (e.target == personModal) {
            personModal.style.display = "none";
        }
    });

    function PassDataToPartialView(id){
        fetch("~/person/getPersonById/"+id).then(res => res.json())
                .then(data => {
                    // populate form fields
                    document.getElementById("Id").value = data.id;
                    document.getElementById("FirstName").value = data.FirstName;
                    document.getElementById("LastName").value = data.LastName;
                    document.getElementById("Email").value = data.Email;
                    document.getElementById("PhoneNumber").value = data.PhoneNumber;
                    document.getElementById("CountryId").value = data.countryId;

                    // show modal
                    modal.style.display = "block";
                })
    }
</script>
<style>
    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background: rgba(0,0,0,0.95);
        backdrop-filter: blur(5px);
    }

    .modal-content {
        background: var(--card);
        margin: 10% auto;
        padding: 24px;
        border-radius: var(--radius);
        width: 400px;
        max-width: 90%;
        box-shadow: 0 8px 24px rgba(0,0,0,0.7);
        border: 1px solid rgba(255,255,255,0.1);
    }
</style>